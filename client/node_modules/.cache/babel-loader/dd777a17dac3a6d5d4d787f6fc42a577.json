{"ast":null,"code":"import _regeneratorRuntime from\"/home/mihirpanchal/PROJECTS/book_store/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/regenerator\";import _asyncToGenerator from\"/home/mihirpanchal/PROJECTS/book_store/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";import _slicedToArray from\"/home/mihirpanchal/PROJECTS/book_store/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import React,{useContext,useEffect}from'react';import{GlobalState}from'../../../GlobalState';import{Link}from'react-router-dom';import axios from'axios';function OrderHistory(){var state=useContext(GlobalState);var _state$userAPI$histor=_slicedToArray(state.userAPI.history,2),history=_state$userAPI$histor[0],setHistory=_state$userAPI$histor[1];var _state$userAPI$isAdmi=_slicedToArray(state.userAPI.isAdmin,1),isAdmin=_state$userAPI$isAdmi[0];var _state$token=_slicedToArray(state.token,1),token=_state$token[0];useEffect(function(){if(token){var getHistory=/*#__PURE__*/function(){var _ref=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(){var res,_res;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:if(!isAdmin){_context.next=7;break;}_context.next=3;return axios.get('/api/payment',{headers:{Authorization:token}});case 3:res=_context.sent;setHistory(res.data);_context.next=11;break;case 7:_context.next=9;return axios.get('/user/history',{headers:{Authorization:token}});case 9:_res=_context.sent;setHistory(_res.data);case 11:case\"end\":return _context.stop();}}},_callee);}));return function getHistory(){return _ref.apply(this,arguments);};}();getHistory();}},[token,isAdmin,setHistory]);return/*#__PURE__*/React.createElement(\"div\",{className:\"history-page\"},/*#__PURE__*/React.createElement(\"h2\",null,\"History\"),/*#__PURE__*/React.createElement(\"h4\",null,\"You have \",history.length,\" ordered\"),/*#__PURE__*/React.createElement(\"table\",null,/*#__PURE__*/React.createElement(\"thead\",null,/*#__PURE__*/React.createElement(\"tr\",null,/*#__PURE__*/React.createElement(\"th\",null,\"Payment ID\"),/*#__PURE__*/React.createElement(\"th\",null,\"Date of Purchased\"),/*#__PURE__*/React.createElement(\"th\",null))),/*#__PURE__*/React.createElement(\"tbody\",null,history.map(function(items){return/*#__PURE__*/React.createElement(\"tr\",{key:items._id},/*#__PURE__*/React.createElement(\"td\",null,items.paymentID),/*#__PURE__*/React.createElement(\"td\",null,new Date(items.createdAt).toLocaleDateString()),/*#__PURE__*/React.createElement(\"td\",null,/*#__PURE__*/React.createElement(Link,{to:\"/history/\".concat(items._id)},\"View\")));}))));}export default OrderHistory;","map":{"version":3,"sources":["/home/mihirpanchal/PROJECTS/book_store/client/src/components/mainpages/history/OrderHistory.js"],"names":["React","useContext","useEffect","GlobalState","Link","axios","OrderHistory","state","userAPI","history","setHistory","isAdmin","token","getHistory","get","headers","Authorization","res","data","length","map","items","_id","paymentID","Date","createdAt","toLocaleDateString"],"mappings":"yeAAA,MAAOA,CAAAA,KAAP,EAAeC,UAAf,CAA2BC,SAA3B,KAA2C,OAA3C,CACA,OAAQC,WAAR,KAA0B,sBAA1B,CACA,OAAQC,IAAR,KAAmB,kBAAnB,CACA,MAAOC,CAAAA,KAAP,KAAkB,OAAlB,CAEA,QAASC,CAAAA,YAAT,EAAwB,CACpB,GAAMC,CAAAA,KAAK,CAAGN,UAAU,CAACE,WAAD,CAAxB,CADoB,yCAEUI,KAAK,CAACC,OAAN,CAAcC,OAFxB,IAEbA,OAFa,0BAEJC,UAFI,mEAGFH,KAAK,CAACC,OAAN,CAAcG,OAHZ,IAGbA,OAHa,0DAIJJ,KAAK,CAACK,KAJF,IAIbA,KAJa,iBAOpBV,SAAS,CAAC,UAAM,CACZ,GAAGU,KAAH,CAAS,CACL,GAAMC,CAAAA,UAAU,0FAAG,oJACZF,OADY,+CAEON,CAAAA,KAAK,CAACS,GAAN,CAAU,cAAV,CAA0B,CACxCC,OAAO,CAAE,CAACC,aAAa,CAAEJ,KAAhB,CAD+B,CAA1B,CAFP,QAELK,GAFK,eAKXP,UAAU,CAACO,GAAG,CAACC,IAAL,CAAV,CALW,oDAOOb,CAAAA,KAAK,CAACS,GAAN,CAAU,eAAV,CAA2B,CACzCC,OAAO,CAAE,CAACC,aAAa,CAAEJ,KAAhB,CADgC,CAA3B,CAPP,QAOLK,IAPK,eAUXP,UAAU,CAACO,IAAG,CAACC,IAAL,CAAV,CAVW,uDAAH,kBAAVL,CAAAA,UAAU,0CAAhB,CAaAA,UAAU,GACb,CACJ,CAjBQ,CAiBP,CAACD,KAAD,CAAQD,OAAR,CAAiBD,UAAjB,CAjBO,CAAT,CAmBA,mBACI,2BAAK,SAAS,CAAC,cAAf,eACI,wCADJ,cAGI,0CAAcD,OAAO,CAACU,MAAtB,YAHJ,cAKI,8CACI,8CACI,2CACI,2CADJ,cAEI,kDAFJ,cAGI,8BAHJ,CADJ,CADJ,cAQI,iCAEQV,OAAO,CAACW,GAAR,CAAY,SAAAC,KAAK,qBACb,0BAAI,GAAG,CAAEA,KAAK,CAACC,GAAf,eACI,8BAAKD,KAAK,CAACE,SAAX,CADJ,cAEI,8BAAK,GAAIC,CAAAA,IAAJ,CAASH,KAAK,CAACI,SAAf,EAA0BC,kBAA1B,EAAL,CAFJ,cAGI,2CAAI,oBAAC,IAAD,EAAM,EAAE,oBAAcL,KAAK,CAACC,GAApB,CAAR,SAAJ,CAHJ,CADa,EAAjB,CAFR,CARJ,CALJ,CADJ,CA4BH,CAED,cAAehB,CAAAA,YAAf","sourcesContent":["import React, {useContext, useEffect} from 'react'\nimport {GlobalState} from '../../../GlobalState'\nimport {Link} from 'react-router-dom'\nimport axios from 'axios'\n\nfunction OrderHistory() {\n    const state = useContext(GlobalState)\n    const [history, setHistory] = state.userAPI.history\n    const [isAdmin] = state.userAPI.isAdmin\n    const [token] = state.token\n    \n\n    useEffect(() => {\n        if(token){\n            const getHistory = async() =>{\n                if(isAdmin){\n                    const res = await axios.get('/api/payment', {\n                        headers: {Authorization: token}\n                    })\n                    setHistory(res.data)\n                }else{\n                    const res = await axios.get('/user/history', {\n                        headers: {Authorization: token}\n                    })\n                    setHistory(res.data)\n                }\n            }\n            getHistory()\n        }\n    },[token, isAdmin, setHistory])\n\n    return (\n        <div className=\"history-page\">\n            <h2>History</h2>\n\n            <h4>You have {history.length} ordered</h4>\n\n            <table>\n                <thead>\n                    <tr>\n                        <th>Payment ID</th>\n                        <th>Date of Purchased</th>\n                        <th></th>\n                    </tr>\n                </thead>\n                <tbody>\n                    {\n                        history.map(items => (\n                            <tr key={items._id}>\n                                <td>{items.paymentID}</td>\n                                <td>{new Date(items.createdAt).toLocaleDateString()}</td>\n                                <td><Link to={`/history/${items._id}`}>View</Link></td>\n                            </tr>\n                        ))\n                    }\n                </tbody>\n            </table>\n        </div>\n    )\n}\n\nexport default OrderHistory\n"]},"metadata":{},"sourceType":"module"}