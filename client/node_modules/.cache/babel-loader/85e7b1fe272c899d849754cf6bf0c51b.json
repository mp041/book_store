{"ast":null,"code":"import _regeneratorRuntime from\"/home/mihirpanchal/PROJECTS/book_store/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/regenerator\";import _asyncToGenerator from\"/home/mihirpanchal/PROJECTS/book_store/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";import _slicedToArray from\"/home/mihirpanchal/PROJECTS/book_store/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import React,{createContext,useState,useEffect}from'react';import ProductsAPI from'./api/ProductsAPI';import UserAPI from'./api/UserAPI';import CategoriesAPI from'./api/CategoriesAPI';import axios from'axios';export var GlobalState=createContext();export var DataProvider=function DataProvider(_ref){var children=_ref.children;var _useState=useState(false),_useState2=_slicedToArray(_useState,2),token=_useState2[0],setToken=_useState2[1];useEffect(function(){var firstLogin=localStorage.getItem('firstLogin');if(firstLogin){var refreshToken=/*#__PURE__*/function(){var _ref2=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(){var res;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:_context.next=2;return axios.get('/user/refresh_token');case 2:res=_context.sent;setToken(res.data.accesstoken);setTimeout(function(){refreshToken();},10*60*1000);case 5:case\"end\":return _context.stop();}}},_callee);}));return function refreshToken(){return _ref2.apply(this,arguments);};}();refreshToken();}},[]);var state={token:[token,setToken],productsAPI:ProductsAPI(),userAPI:UserAPI(token),categoriesAPI:CategoriesAPI()};return/*#__PURE__*/React.createElement(GlobalState.Provider,{value:state},children);};","map":{"version":3,"sources":["/home/mihirpanchal/PROJECTS/book_store/client/src/GlobalState.js"],"names":["React","createContext","useState","useEffect","ProductsAPI","UserAPI","CategoriesAPI","axios","GlobalState","DataProvider","children","token","setToken","firstLogin","localStorage","getItem","refreshToken","get","res","data","accesstoken","setTimeout","state","productsAPI","userAPI","categoriesAPI"],"mappings":"yeAAA,MAAOA,CAAAA,KAAP,EAAeC,aAAf,CAA8BC,QAA9B,CAAwCC,SAAxC,KAAwD,OAAxD,CACA,MAAOC,CAAAA,WAAP,KAAwB,mBAAxB,CACA,MAAOC,CAAAA,OAAP,KAAoB,eAApB,CACA,MAAOC,CAAAA,aAAP,KAA0B,qBAA1B,CAEA,MAAOC,CAAAA,KAAP,KAAkB,OAAlB,CAEA,MAAO,IAAMC,CAAAA,WAAW,CAAGP,aAAa,EAAjC,CAGP,MAAO,IAAMQ,CAAAA,YAAY,CAAG,QAAfA,CAAAA,YAAe,MAAe,IAAbC,CAAAA,QAAa,MAAbA,QAAa,eACbR,QAAQ,CAAC,KAAD,CADK,wCAChCS,KADgC,eACzBC,QADyB,eAIvCT,SAAS,CAAC,UAAK,CACX,GAAMU,CAAAA,UAAU,CAAGC,YAAY,CAACC,OAAb,CAAqB,YAArB,CAAnB,CACA,GAAGF,UAAH,CAAc,CACV,GAAMG,CAAAA,YAAY,2FAAG,iKACCT,CAAAA,KAAK,CAACU,GAAN,CAAU,qBAAV,CADD,QACXC,GADW,eAGjBN,QAAQ,CAACM,GAAG,CAACC,IAAJ,CAASC,WAAV,CAAR,CAEAC,UAAU,CAAC,UAAM,CACbL,YAAY,GACf,CAFS,CAEP,GAAK,EAAL,CAAU,IAFH,CAAV,CALiB,sDAAH,kBAAZA,CAAAA,YAAY,2CAAlB,CASAA,YAAY,GACf,CACJ,CAdQ,CAcP,EAdO,CAAT,CAkBA,GAAMM,CAAAA,KAAK,CAAG,CACVX,KAAK,CAAE,CAACA,KAAD,CAAQC,QAAR,CADG,CAEVW,WAAW,CAAEnB,WAAW,EAFd,CAGVoB,OAAO,CAAEnB,OAAO,CAACM,KAAD,CAHN,CAIVc,aAAa,CAAEnB,aAAa,EAJlB,CAAd,CAOA,mBACI,oBAAC,WAAD,CAAa,QAAb,EAAsB,KAAK,CAAEgB,KAA7B,EACKZ,QADL,CADJ,CAKH,CAlCM","sourcesContent":["import React, {createContext, useState, useEffect} from 'react'\nimport ProductsAPI from './api/ProductsAPI'\nimport UserAPI from './api/UserAPI'\nimport CategoriesAPI from './api/CategoriesAPI'\n\nimport axios from 'axios'\n\nexport const GlobalState = createContext()\n\n\nexport const DataProvider = ({children}) =>{\n    const [token, setToken] = useState(false)\n\n\n    useEffect(() =>{\n        const firstLogin = localStorage.getItem('firstLogin')\n        if(firstLogin){\n            const refreshToken = async () =>{\n                const res = await axios.get('/user/refresh_token')\n        \n                setToken(res.data.accesstoken)\n    \n                setTimeout(() => {\n                    refreshToken()\n                }, 10 * 60 * 1000)\n            }\n            refreshToken()\n        }\n    },[])\n\n\n    \n    const state = {\n        token: [token, setToken],\n        productsAPI: ProductsAPI(),\n        userAPI: UserAPI(token),\n        categoriesAPI: CategoriesAPI()\n    }\n\n    return (\n        <GlobalState.Provider value={state}>\n            {children}\n        </GlobalState.Provider>\n    )\n}"]},"metadata":{},"sourceType":"module"}